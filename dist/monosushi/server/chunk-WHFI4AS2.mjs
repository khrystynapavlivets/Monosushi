import './polyfills.server.mjs';
import{a as Mt,b as Tt,c as W,e as X,f as Z,g as tt,i as I,j as et}from"./chunk-7ECUANP6.mjs";import"./chunk-IJCMACY3.mjs";import{I as kt,J as Vt,K as It,b as R,d as f,e as L,f as G,g as z,h as Et,i as H,j as Y,k as Pt,l as At,m as Dt,n as ut,o as K,p as J,q as Q}from"./chunk-YTFM73EE.mjs";import{a as xt,e as vt,p as yt,r as St,s as Ft,t as wt,v as gt}from"./chunk-AEL4QSO4.mjs";import{$ as nt,Ab as ht,Bb as B,Cb as N,Db as o,Eb as a,Fb as m,Ib as C,Lb as p,Mb as c,Rc as _t,Ub as l,Uc as bt,Vb as v,Wb as P,Xc as Ct,Ya as k,Yb as A,Yc as q,Zb as ot,Zc as D,_b as w,aa as rt,ab as d,ac as U,bb as _,cc as ft,dc as $,ea as at,ka as E,la as lt,sb as y,ta as h,ua as g,ub as s,vb as S,xb as V,zb as b}from"./chunk-2Q732AJT.mjs";import{i as j}from"./chunk-3CVZQN5Z.mjs";var zt=()=>["discount"],Ht=()=>["category"],Yt=()=>["product"],Kt=()=>["order"],dt=(()=>{let n=class n{constructor(t,e){this.router=t,this.accountService=e}ngOnInit(){}logOut(){this.router.navigate(["/"]),localStorage.removeItem("currentUser"),this.accountService.isUserLogin$.next(!0)}};n.\u0275fac=function(e){return new(e||n)(_(St),_(It))},n.\u0275cmp=E({type:n,selectors:[["app-admin"]],standalone:!0,features:[A],decls:16,vars:8,consts:[[1,"admin_panel","d-flex","flex-column"],["id","v-pills-tab","role","tablist","aria-orientation","vertical",1,"nav","nav-pills","my-5","ms-5"],["id","v-pills-tab","role","tablist","aria-orientation","vertical",1,"nav","nav-pills","d-flex","flex-column"],["routerLinkActive","active","type","button",1,"nav-link",3,"routerLink"],["type","button",1,"btn-out","my-3",3,"click"],["id","v-pills-tabContent",1,"tab-content","ms-5","ps-5","w-75","d-flex","flex-column"]],template:function(e,u){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),l(4,"\u0410\u043A\u0446\u0456\u0457"),a(),o(5,"button",3),l(6,"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0456\u0457"),a(),o(7,"button",3),l(8,"\u041F\u0440\u043E\u0434\u0443\u043A\u0442\u0438"),a(),o(9,"button",3),l(10,"\u0417\u0430\u043C\u043E\u0432\u043B\u0435\u043D\u043D\u044F"),a(),o(11,"button",4),p("click",function(){return u.logOut()}),o(12,"b"),l(13,"\u0412\u0418\u0425\u0406\u0414"),a()()(),o(14,"div",5),m(15,"router-outlet"),a()()()),e&2&&(d(3),s("routerLink",ot(4,zt)),d(2),s("routerLink",ot(5,Ht)),d(2),s("routerLink",ot(6,Yt)),d(2),s("routerLink",ot(7,Kt)))},dependencies:[D,Ft,wt,yt,vt],styles:[".admin_panel[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding:20px 50px;background-color:#fff;color:#000;border-color:#b5d8f7;outline:none;border-bottom:1px solid lightgray;border-right:1px solid lightgray;border-left:1px solid transparent;border-radius:0%;box-sizing:border-box;transition:.35s}.admin_panel[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:#b5d8f7}.active[_ngcontent-%COMP%]{border:2px solid #b5d8f7;border-radius:5px;border-color:#b5d8f7;border-top:1px solid none;border-bottom:1px solid lightgray;border-right:1px solid lightgray;border-top:3px solid #b5d8f7;border-left:1px solid white;border-right:1px solid transparent;font-weight:700;padding:20px 40px;box-sizing:border-box}.btn-out[_ngcontent-%COMP%]{width:70%;border-radius:10px;border:2px solid #b5d8f7;background-color:#b5d8f7;transition:.35s;cursor:pointer;padding:14px 16px;font-size:17px;margin:0 auto}.btn-out[_ngcontent-%COMP%]:hover{background-color:initial;color:#000}"]});let i=n;return i})();var ct=(()=>{let n=class n{constructor(t){this.http=t,this.url=Vt.BACKEND_URL,this.api={categories:`${this.url}/categories`}}getAll(){return this.http.get(this.api.categories)}create(t){return this.http.post(this.api.categories,t)}update(t,e){return this.http.patch(`${this.api.categories}/${e}`,t)}delete(t){return this.http.delete(`${this.api.categories}/${t}`)}};n.\u0275fac=function(e){return new(e||n)(at(xt))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();var Jt=(i,n)=>n.id,Bt=i=>({color:i});function Qt(i,n){if(i&1){let r=C();o(0,"div",15)(1,"input",16),p("change",function(e){h(r);let u=c(2);return g(u.upload(e))}),a()(),o(2,"div",17),m(3,"div",18),a()}if(i&2){let r=c(2);d(3),S("width",r.uploadPercent,"%")}}function Wt(i,n){if(i&1){let r=C();m(0,"img",19),o(1,"button",20),p("click",function(){h(r);let e=c(2);return g(e.deleteImage())}),l(2," \u0412\u0418\u0414\u0410\u041B\u0418\u0422\u0418 "),a()}if(i&2){let r=c(2);s("src",r.valueByControl("imagePath"),k)}}function Xt(i,n){if(i&1){let r=C();o(0,"div",2)(1,"form",8),p("ngSubmit",function(){h(r);let e=c();return g(e.addCategory())}),o(2,"div",9)(3,"div",10),m(4,"input",11),a(),o(5,"div",10),m(6,"input",12),o(7,"div",13),l(8,"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u0448\u043B\u044F\u0445"),a()()(),y(9,Qt,4,2)(10,Wt,3,1),o(11,"button",14),l(12),a()()()}if(i&2){let r=c();d(),s("formGroup",r.categoryForm),d(8),b(9,r.isUploaded?-1:9),d(),b(10,r.isUploaded?10:-1),d(),S("background-color",r.primaryColor),s("disabled",r.categoryForm.invalid||!r.isUploaded),d(),P(" ",r.editStatus?"\u0417\u0411\u0415\u0420\u0415\u0413\u0422\u0418":"\u0414\u041E\u0414\u0410\u0422\u0418"," ")}}function Zt(i,n){i&1&&(o(0,"span"),l(1,"..."),a())}function te(i,n){if(i&1){let r=C();o(0,"tr")(1,"td"),l(2),a(),o(3,"td"),l(4),U(5,"slice"),y(6,Zt,2,0,"span"),a(),o(7,"td",21),l(8),a(),o(9,"td"),m(10,"img",22),a(),o(11,"td")(12,"button",23),p("click",function(){let e=h(r).$implicit,u=c();return g(u.editCategory(e))})("click",function(){h(r);let e=c();return g(e.AddCategoryForm())}),l(13," \u0420\u0415\u0414\u0410\u0413\u0423\u0412\u0410\u0422\u0418 "),a(),o(14,"button",24),p("click",function(){let e=h(r).$implicit,u=c();return g(u.deleteCategory(e))}),l(15," \u0412\u0418\u0414\u0410\u041B\u0418\u0422\u0418 "),a()()()}if(i&2){let r=n.$implicit,t=c();d(2),v(r.id),d(2),P(" ",$(5,12,r.name,0,70)," "),d(2),b(6,r.name.length>70?6:-1),d(2),P(" ",r.path," "),d(2),s("src",r.imagePath,k),d(2),V(w(16,Bt,t.primaryColor)),d(2),V(w(18,Bt,t.primaryColor)),S("cursor",t.editStatus?"not-allowed":"pointer"),s("disabled",t.editStatus)}}var st=(()=>{let n=class n{constructor(t,e,u){this.fb=t,this.categoryService=e,this.storage=u,this.adminCategories=[],this.editStatus=!1,this.isUploaded=!1,this.currentCategoryId=0,this.addCategoryForm=!0,this.primaryColor="#b5d8f7"}ngOnInit(){this.initCategoryForm(),this.loadCategories()}toggleAddCategoryForm(){this.addCategoryForm=!this.addCategoryForm}AddCategoryForm(){this.addCategoryForm=!1}initCategoryForm(){this.categoryForm=this.fb.group({name:[null,f.required],path:[null,f.required],imagePath:[,f.required]})}loadCategories(){this.categoryService.getAll().subscribe(t=>{this.adminCategories=t})}addCategory(){this.editStatus?this.categoryService.update(this.categoryForm.value,this.currentCategoryId).subscribe(()=>{this.loadCategories()}):this.categoryService.create(this.categoryForm.value).subscribe(()=>{this.loadCategories()}),this.editStatus=!1,this.categoryForm.reset(),this.isUploaded=!1,this.uploadPercent=0}editCategory(t){this.categoryForm.patchValue({name:t.name,path:t.path,imagePath:t.imagePath}),this.editStatus=!0,this.currentCategoryId=t.id,this.isUploaded=!0}deleteCategory(t){this.categoryService.delete(t.id).subscribe(()=>{this.loadCategories()})}upload(t){let e=t.target.files[0];this.uploadFile("images",e.name,e).then(u=>{this.categoryForm.patchValue({imagePath:u}),this.isUploaded=!0}).catch(u=>{console.log(u)})}uploadFile(t,e,u){return j(this,null,function*(){let F=`${t}/${e}`,M="";if(u)try{let x=I(this.storage,F),T=et(x,u);X(T).subscribe(it=>{this.uploadPercent=it.progress}),yield T,M=yield tt(x)}catch(x){console.error(x)}else console.log("wrong format");return Promise.resolve(M)})}deleteImage(){let t=I(this.storage,this.valueByControl("imagePath"));Z(t).then(()=>{console.log("File deleted"),this.isUploaded=!1,this.uploadPercent=0,this.categoryForm.patchValue({imagePath:null})})}valueByControl(t){return this.categoryForm.get(t)?.value}};n.\u0275fac=function(e){return new(e||n)(_(K),_(ct),_(W))},n.\u0275cmp=E({type:n,selectors:[["app-admin-category"]],standalone:!0,features:[A],decls:22,vars:1,consts:[[1,"container-fluid","d-flex","flex-column"],["type","button",1,"btnAddCategoryForm","fw-bold",3,"click"],[1,"py-3"],[1,"my-5",2,"display","grid","place-items","center","width","100%"],[1,"table"],["scope","col",2,"width","10%"],["scope","col",2,"width","20%"],["scope","col",2,"width","40%"],[3,"ngSubmit","formGroup"],[1,"d-flex","flex-row","justify-content-between"],[1,"my-3",2,"width","48%"],["formControlName","name","name","name","type","text","placeholder","*\u041D\u0410\u0417\u0412\u0410","required","",1,"form-control",2,"height","3.5rem"],["formControlName","path","name","path","type","text","placeholder","*\u0428\u043B\u044F\u0445","required","",1,"form-control",2,"height","3.5rem"],[1,"invalid-feedback"],["type","submit",1,"btn","fw-bold","my-3","w-100","border-0","btnSaveAdd",3,"disabled"],[1,"mb-3"],["type","file","required","",1,"form-control",3,"change"],[1,"progress","mb-3"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped"],["width","100px","alt","",1,"m-3",3,"src"],["type","button",1,"btn","fw-bold",3,"click"],[1,"fw-medium"],["alt","","height","50px",3,"src"],["type","button",1,"btn","btnEdDel","fw-bold",2,"color","primaryColor",3,"click"],["type","button",1,"btn","btnEdDel","fw-bold",3,"click","disabled"]],template:function(e,u){e&1&&(o(0,"div",0)(1,"div")(2,"button",1),p("click",function(){return u.toggleAddCategoryForm()}),l(3," \u0414\u041E\u0414\u0410\u0422\u0418 \u041A\u0410\u0422\u0415\u0413\u041E\u0420\u0406\u042E "),a(),y(4,Xt,13,7,"div",2),o(5,"div",3)(6,"table",4)(7,"thead")(8,"tr")(9,"th",5),l(10,"\u2116"),a(),o(11,"th",6),l(12,"\u041D\u0410\u0417\u0412\u0410"),a(),o(13,"th",7),l(14,"\u0428\u041B\u042F\u0425"),a(),o(15,"th",6),l(16,"\u041A\u0410\u0420\u0422\u0418\u041D\u041A\u0410"),a(),o(17,"th",6),l(18,"\u0414\u0406\u0407"),a()()(),o(19,"tbody"),B(20,te,16,20,"tr",null,Jt),a()()()()()),e&2&&(d(4),b(4,u.addCategoryForm?-1:4),d(16),N(u.adminCategories))},dependencies:[D,q,J,z,R,L,G,ut,Q,H,Y],styles:[".btnAddCategoryForm[_ngcontent-%COMP%]{width:198px;height:40px;background-color:#fff;border-radius:5px;border:2px solid #b5d8f7}.btnAddCategoryForm[_ngcontent-%COMP%]:hover{background-color:#b5d8f7}tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:2px solid #b5d8f7}.btnEdDel[_ngcontent-%COMP%]:hover{text-decoration:underline}"]});let i=n;return i})();var $t=(()=>{let n=class n{constructor(t){this.storage=t,this.uploadPercent=0}uploadFile(t,e,u){return j(this,null,function*(){let F=`${t}/${e}`,M="";if(u)try{let x=I(this.storage,F),T=et(x,u);X(T).subscribe(it=>{this.uploadPercent=it.progress}),yield T,M=yield tt(x)}catch(x){console.error(x)}else console.log("wrong format");return Promise.resolve(M)})}deleteUploadFile(t){let e=I(this.storage,t);return Z(e)}};n.\u0275fac=function(e){return new(e||n)(at(W))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();var ie=i=>({show:i}),oe=i=>({"background-color":i}),qt=i=>({color:i});function ne(i,n){if(i&1&&(o(0,"option",15),l(1),a()),i&2){let r=n.$implicit;s("ngValue",r),d(),v(r.name)}}function re(i,n){if(i&1){let r=C();o(0,"div",20)(1,"input",25),p("change",function(e){h(r);let u=c(2);return g(u.upload(e))}),a()(),o(2,"div",26),m(3,"div",27),a()}if(i&2){let r=c(2);d(3),S("width",r.uploadPercent,"%")}}function ae(i,n){if(i&1){let r=C();m(0,"img",28),o(1,"Button",29),p("click",function(){h(r);let e=c(2);return g(e.deleteImage())}),l(2,"delete"),a()}if(i&2){let r=c(2);s("src",r.valueByControl("imagePath"),k)}}function le(i,n){if(i&1){let r=C();o(0,"div",3)(1,"div",11)(2,"form",12),p("ngSubmit",function(){h(r);let e=c();return g(e.addProduct())}),o(3,"div",13)(4,"select",14,0),B(6,ne,2,2,"option",15,ht),a()(),o(8,"div",16)(9,"div",17),m(10,"input",18),a(),o(11,"div",17),m(12,"input",19),a()(),o(13,"div",20),m(14,"textarea",21),a(),o(15,"div",16)(16,"div",17),m(17,"input",22),a(),o(18,"div",17),m(19,"input",23),a()(),y(20,re,4,2)(21,ae,3,1),o(22,"button",24),l(23),a()()()()}if(i&2){let r=c();s("ngClass",w(7,ie,r.isOpen)),d(2),s("formGroup",r.productForm),d(4),N(r.adminCategories),d(14),b(20,r.isUploaded?-1:20),d(),b(21,r.isUploaded?21:-1),d(),s("disabled",r.productForm.invalid)("ngStyle",w(9,oe,r.primaryColor)),d(),P(" ",r.editStatus?"\u0417\u0411\u0415\u0420\u0415\u0413\u0422\u0418":"\u0414\u041E\u0414\u0410\u0422\u0418"," ")}}function ue(i,n){i&1&&(o(0,"span"),l(1,"..."),a())}function de(i,n){if(i&1){let r=C();o(0,"tr")(1,"td"),l(2),a(),o(3,"td"),l(4),a(),o(5,"td"),l(6),a(),o(7,"td"),l(8),U(9,"slice"),y(10,ue,2,0,"span"),a(),o(11,"td"),l(12),a(),o(13,"td"),l(14),a(),o(15,"td"),m(16,"img",30),a(),o(17,"td")(18,"button",31),p("click",function(){let e=h(r).$implicit,u=c();return g(u.editProduct(e))}),l(19," \u0420\u0415\u0414\u0410\u0413\u0423\u0412\u0410\u0422\u0418 "),a(),o(20,"button",32),p("click",function(){let e=h(r).$implicit,u=c();return g(u.deleteProduct(e))}),l(21," \u0412\u0418\u0414\u0410\u041B\u0418\u0422\u0418 "),a()()()}if(i&2){let r=n.$implicit,t=c();d(2),v(r.id),d(2),v(r.category.name),d(2),v(r.name),d(2),P(" ",$(9,15,r.description,0,30)," "),d(2),b(10,r.description.length>20?10:-1),d(2),v(r.weight),d(2),v(r.price),d(2),s("src",r.imagePath,k),d(2),V(w(19,qt,t.primaryColor)),d(2),V(w(21,qt,t.primaryColor)),S("cursor",t.editStatus?"not-allowed":"pointer"),s("disabled",t.editStatus)}}var mt=(()=>{let n=class n{constructor(t,e,u,F){this.fb=t,this.categoryService=e,this.productService=u,this.imageService=F,this.adminCategories=[],this.adminProducts=[],this.editStatus=!1,this.uploadPercent=0,this.isUploaded=!1,this.isOpen=!1,this.currentProductId=0,this.primaryColor="#b5d8f7",this.addProductForm=!0}ngOnInit(){this.initProductForm(),this.loadCategories(),this.loadProduct()}initProductForm(){this.productForm=this.fb.group({category:[null,f.required],name:[null,f.required],path:[null,f.required],description:[null,f.required],weight:[null,f.required],price:[null,f.required],imagePath:[null,f.required],count:[1]})}loadCategories(){this.categoryService.getAll().subscribe(t=>{this.adminCategories=t,this.productForm.patchValue({category:this.adminCategories[0].id})})}loadProduct(){this.productService.getAll().subscribe(t=>{this.adminProducts=t})}addProduct(){this.editStatus?this.productService.update(this.productForm.value,this.currentProductId).subscribe(()=>{this.loadProduct(),this.isOpen=!1,this.editStatus=!1}):this.productService.create(this.productForm.value).subscribe(()=>{this.loadProduct(),this.isOpen=!1,this.editStatus=!1}),this.editStatus=!1,this.isUploaded=!1,this.productForm.reset()}editProduct(t){let e=this.adminCategories.find(u=>u.name===t.category.name);this.productForm.patchValue({category:e,name:t.name,path:t.path,description:t.description,weight:t.weight,price:t.price,imagePath:t.imagePath}),this.isOpen=!0,this.isUploaded=!0,this.editStatus=!0,this.currentProductId=t.id}deleteProduct(t){this.productService.delete(t.id).subscribe(()=>{this.loadProduct()})}upload(t){let e=t.target.files[0];this.imageService.uploadFile("images",e.name,e).then(u=>{this.productForm.patchValue({imagePath:u}),this.isUploaded=!0}).catch(u=>{console.log(u)})}deleteImage(){this.imageService.deleteUploadFile(this.valueByControl("imagePath")).then(()=>{this.isUploaded=!1,this.uploadPercent=0,this.productForm.patchValue({imagePath:null})}).catch(t=>{console.log(t)})}valueByControl(t){return this.productForm.get(t)?.value}toggleOpenForm(){this.isOpen=!this.isOpen}AddProductForm(){this.addProductForm=!1}};n.\u0275fac=function(e){return new(e||n)(_(K),_(ct),_(Mt),_($t))},n.\u0275cmp=E({type:n,selectors:[["app-admin-product"]],standalone:!0,features:[A],decls:27,vars:2,consts:[["category",""],[1,"container-fluid","d-flex","flex-column"],[1,"btnAddProductForm","fw-bold",3,"click"],["id","collapseExample",1,"collapse",3,"ngClass"],[1,"col-12","mt-5"],[1,"table"],["scope","col"],["scope","col",1,"col-2"],["scope","col",1,"col-4"],["scope","col",1,"col-3"],["scope","col",1,"col-1"],[1,"col-12"],[3,"ngSubmit","formGroup"],[1,"col","mb-3","my-3"],["formControlName","category","name","productCategory",1,"form-select"],["selected","",3,"ngValue"],[1,"row"],[1,"col","mb-3"],["formControlName","name","name","name","type","text","id","name","placeholder","*\u041D\u0430\u0437\u0432\u0430",1,"form-control"],["formControlName","path","name","path","type","text","id","path","placeholder","*\u0428\u043B\u044F\u0445",1,"form-control"],[1,"mb-3"],["formControlName","description","name","description","id","description","placeholder","*\u0406\u043D\u0433\u0440\u0435\u0434\u0456\u0454\u043D\u0442\u0438",1,"form-control"],["formControlName","weight","name","weight","type","text","id","weight","placeholder","*\u0412\u0430\u0433\u0430",1,"form-control"],["formControlName","price","name","price","type","number","id","price","placeholder","*\u0426\u0456\u043D\u0430",1,"form-control"],["type","submit",1,"btn","border-0","w-100","btnSaveAdd",3,"disabled","ngStyle"],["type","file","id","formFile",1,"form-control",3,"change"],[1,"progress","mb-3"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped"],["width","100px","alt","",1,"m-3",3,"src"],["type","button",1,"btn","btn-danger",3,"click"],["alt","","height","50px",3,"src"],["type","button",1,"btn","btnEdDel","fw-bold",2,"color","primaryColor",3,"click"],["type","button",1,"btn","btnEdDel","fw-bold",3,"click","disabled"]],template:function(e,u){e&1&&(o(0,"div",1)(1,"button",2),p("click",function(){return u.toggleOpenForm()}),l(2),a(),y(3,le,24,11,"div",3),o(4,"div",4)(5,"table",5)(6,"thead")(7,"tr")(8,"th",6),l(9,"\u2116"),a(),o(10,"th",7),l(11,"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0456\u044F"),a(),o(12,"th",8),l(13,"\u041D\u0430\u0437\u0432\u0430"),a(),o(14,"th",9),l(15,"\u041E\u043F\u0438\u0441"),a(),o(16,"th",10),l(17,"\u0412\u0430\u0433\u0430"),a(),o(18,"th",10),l(19,"\u0426\u0456\u043D\u0430"),a(),o(20,"th",7),l(21,"\u041A\u0430\u0440\u0442\u0438\u043D\u043A\u0430"),a(),o(22,"th",10),l(23,"\u0414\u0456\u0457"),a()()(),o(24,"tbody"),B(25,de,22,23,"tr",null,ht),a()()()()),e&2&&(d(2),P(" ",u.isOpen?"\u041E\u041D\u041E\u0412\u0418\u0422\u0418 \u041F\u0420\u041E\u0414\u0423\u041A\u0422":"\u0414\u041E\u0414\u0410\u0422\u0418 \u041F\u0420\u041E\u0414\u0423\u041A\u0422"," "),d(),b(3,u.isOpen?3:-1),d(22),N(u.adminProducts))},dependencies:[J,z,At,Dt,R,Et,Pt,L,G,D,_t,bt,q,Q,H,Y],styles:[".btnAddProductForm[_ngcontent-%COMP%]{width:198px;height:40px;background-color:#fff;border-radius:5px;border:2px solid #b5d8f7}.btnAddProductForm[_ngcontent-%COMP%]:hover{background-color:#b5d8f7}tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:2px solid #b5d8f7}.btnEdDel[_ngcontent-%COMP%]:hover{text-decoration:underline}.btnSaveAdd[_ngcontent-%COMP%]{outline:2px solid #b5d8f7}"]});let i=n;return i})();var ce=(i,n)=>n.id,Rt=i=>({color:i});function se(i,n){if(i&1){let r=C();o(0,"div",12)(1,"input",15),p("change",function(e){h(r);let u=c(2);return g(u.upload(e))}),a()(),o(2,"div",16),m(3,"div",17),a()}if(i&2){let r=c(2);d(3),S("width",r.uploadPercent,"%")}}function me(i,n){if(i&1){let r=C();m(0,"img",18),o(1,"button",19),p("click",function(){h(r);let e=c(2);return g(e.deleteImage())}),l(2,"\u0412\u0418\u0414\u0410\u041B\u0418\u0422\u0418"),a()}if(i&2){let r=c(2);s("src",r.valueByControl("imagePath"),k),d(),S("background-color",r.primaryColor)}}function pe(i,n){if(i&1){let r=C();o(0,"div",3)(1,"form",7),p("ngSubmit",function(){h(r);let e=c();return g(e.addDiscount())}),o(2,"div",8)(3,"div",9),m(4,"input",10),a(),o(5,"div",9),m(6,"input",11),a()(),o(7,"div",12),m(8,"textarea",13),a(),y(9,se,4,2)(10,me,3,3),o(11,"button",14),p("click",function(){h(r);let e=c();return g(e.addDiscount())}),l(12),a()()()}if(i&2){let r=c();d(),s("formGroup",r.discountForm),d(8),b(9,r.isUploaded?-1:9),d(),b(10,r.isUploaded?10:-1),d(),S("background-color",r.primaryColor),s("disabled",r.discountForm.invalid),d(),v(r.editStatus?"\u0417\u0411\u0415\u0420\u0415\u0413\u0422\u0418":"\u0414\u041E\u0414\u0410\u0422\u0418")}}function he(i,n){i&1&&(o(0,"span"),l(1,"..."),a())}function ge(i,n){if(i&1){let r=C();o(0,"tr")(1,"td"),l(2),U(3,"date"),a(),o(4,"td"),l(5),a(),o(6,"td"),l(7),a(),o(8,"td"),l(9),U(10,"slice"),y(11,he,2,0,"span"),a(),o(12,"td"),m(13,"img",20),a(),o(14,"td")(15,"button",21),p("click",function(){let e=h(r).$implicit,u=c();return g(u.editDiscount(e))}),l(16,"\u0420\u0415\u0414\u0410\u0413\u0423\u0412\u0410\u0422\u0418"),a(),o(17,"button",22),p("click",function(){let e=h(r).$implicit,u=c();return g(u.deleteDiscount(e))}),l(18,"\u0412\u0418\u0414\u0410\u041B\u0418\u0422\u0418"),a()()()}if(i&2){let r=n.$implicit,t=c();d(2),v(ft(3,13,t.currentDate,"dd.MM.YY")),d(3),v(r.name),d(2),v(r.title),d(2),P(" ",$(10,16,r.description,0,70)," "),d(2),b(11,r.description.length>70?11:-1),d(2),s("src",r.imagePath,k),d(2),V(w(20,Rt,t.primaryColor)),d(2),V(w(22,Rt,t.primaryColor)),S("cursor",t.editStatus?"not-allowed":"pointer"),s("disabled",t.editStatus)}}var pt=(()=>{let n=class n{constructor(t,e,u){this.discountService=t,this.fb=e,this.storage=u,this.editStatus=!1,this.addDiscountForm=!0,this.currentDate=new Date,this.currentDiscountId=0,this.isUploaded=!1,this.primaryColor="#b5d8f7"}ngOnInit(){this.initDiscountForm(),this.loadDiscounts()}toggleAddDiscountForm(){this.addDiscountForm=!this.addDiscountForm}initDiscountForm(){this.discountForm=this.fb.group({name:[null,f.required],title:[null,f.required],description:[null,f.required],imagePath:[null,f.required]})}loadDiscounts(){this.discountService.getAll().subscribe(t=>{this.adminDiscounts=t})}addDiscount(){this.editStatus?this.discountService.update(this.discountForm.value,this.currentDiscountId).subscribe(()=>{this.loadDiscounts()}):this.discountService.create(this.discountForm.value).subscribe(()=>{this.loadDiscounts()}),this.editStatus=!1,this.discountForm.reset(),this.isUploaded=!1,this.uploadPercent=0}editDiscount(t){this.discountForm.patchValue({name:t.name,title:t.title,description:t.description,imagePath:t.imagePath}),this.editStatus=!0,this.currentDiscountId=t.id,this.isUploaded=!0}deleteDiscount(t){this.discountService.delete(t.id).subscribe(()=>{this.loadDiscounts()})}upload(t){let e=t.target.files[0];this.uploadFile("images",e.name,e).then(u=>{this.discountForm.patchValue({imagePath:u}),this.isUploaded=!0}).catch(u=>{console.log(u)})}uploadFile(t,e,u){return j(this,null,function*(){let F=`${t}/${e}`,M="";if(u)try{let x=I(this.storage,F),T=et(x,u);X(T).subscribe(it=>{this.uploadPercent=it.progress}),yield T,M=yield tt(x)}catch(x){console.error(x)}else console.log("wrong format");return Promise.resolve(M)})}deleteImage(){let t=I(this.storage,this.valueByControl("imagePath"));Z(t).then(()=>{console.log("File deleted"),this.isUploaded=!1,this.uploadPercent=0,this.discountForm.patchValue({imagePath:null})})}valueByControl(t){return this.discountForm.get(t)?.value}};n.\u0275fac=function(e){return new(e||n)(_(Tt),_(K),_(W))},n.\u0275cmp=E({type:n,selectors:[["app-admin-discount"]],standalone:!0,features:[A],decls:24,vars:1,consts:[[1,"container-fluid","d-flex","flex-column"],[1,""],["type","button",1,"btnAddDiscountForm","fw-bold",3,"click"],[1,"py-3"],[1,"my-5",2,"display","grid","place-items","center","width","100%"],[1,"table"],["scope","col"],[3,"ngSubmit","formGroup"],[1,"d-flex","flex-row","justify-content-between"],[1,"my-3",2,"width","48%"],["formControlName","name","name","name","placeholder","*\u041D\u0430\u0437\u0432\u0430","required","",1,"form-control"],["formControlName","title","name","title","placeholder","*\u0417\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A","required","",1,"form-control"],[1,"mb-3"],["formControlName","description","name","description","placeholder","*\u041E\u043F\u0438\u0441","required","",1,"form-control"],["type","button",1,"btn","fw-bold","my-3","w-100",3,"click","disabled"],["type","file","required","",1,"form-control",3,"change"],[1,"progress","mb-3"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped"],["width","100px","alt","",1,"m-3",3,"src"],["type","button",1,"btn","fw-bold",3,"click"],["alt","","height","50px",3,"src"],["type","button",1,"btn","btnEdDel","fw-bold",2,"color","primaryColor",3,"click"],["type","button",1,"btn","btnEdDel","fw-bold",3,"click","disabled"]],template:function(e,u){e&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),p("click",function(){return u.toggleAddDiscountForm()}),l(3,"\u0414\u041E\u0414\u0410\u0422\u0418 \u0410\u041A\u0426\u0406\u042E"),a(),y(4,pe,13,7,"div",3),o(5,"div",4)(6,"table",5)(7,"thead")(8,"tr")(9,"th",6),l(10,"\u0414\u0430\u0442\u0430"),a(),o(11,"th",6),l(12,"\u041D\u0430\u0437\u0432\u0430"),a(),o(13,"th",6),l(14,"\u0417\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A"),a(),o(15,"th",6),l(16,"\u041E\u043F\u0438\u0441"),a(),o(17,"th",6),l(18,"\u041A\u0430\u0440\u0442\u0438\u043D\u043A\u0430"),a(),o(19,"th",6),l(20,"\u0414\u0456\u0457"),a()()(),o(21,"tbody"),B(22,ge,19,24,"tr",null,ce),a()()()()()),e&2&&(d(4),b(4,u.addDiscountForm?-1:4),d(18),N(u.adminDiscounts))},dependencies:[D,q,Ct,J,z,R,L,G,ut,Q,H,Y],styles:[".btnAddDiscountForm[_ngcontent-%COMP%]{width:198px;height:40px;background-color:#fff;border-radius:5px;border:2px solid #b5d8f7}.btnAddDiscountForm[_ngcontent-%COMP%]:hover{background-color:#b5d8f7}"]});let i=n;return i})();var Lt=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=E({type:n,selectors:[["app-admin-order"]],standalone:!0,features:[A],decls:2,vars:0,template:function(e,u){e&1&&(o(0,"p"),l(1,"admin-order works!"),a())}});let i=n;return i})();var fe=[{path:"",component:dt,children:[{path:"category",component:st},{path:"product",component:mt},{path:"discount",component:pt},{path:"order",component:Lt},{path:"",pathMatch:"full",redirectTo:"category"}]}],Gt=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=lt({type:n}),n.\u0275inj=rt({imports:[gt.forChild(fe),gt]});let i=n;return i})();var di=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=lt({type:n}),n.\u0275inj=rt({imports:[D,Gt,kt,dt,st,mt,pt]});let i=n;return i})();export{di as AdminModule};
